<!DOCTYPE html>
<html lang="ru"></html>
<html xmlns="http://www.w3.org/1999/xhtml"></html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<link rel="stylesheet" href="styles.css">
<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.min.js"></script>
  <meta charset="UTF-8"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
  <title>Онлайн журнал оценок</title>
  <style>
    .tabs {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }
    .tabs a {
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
    }
    .tabs a:hover {
        background-color: #ddd;
    }
    .tabs a.active {
        background-color: #ccc;
    }
    .tabcontent {
        display: none;
        padding: 6px 12px;
    }
    .chart_div {
      background-color: #b3b3b3;
    }

    .graficc{
      margin-left: 100px;
    }

    
</style>
</head>
<body>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />


  <div id="tabs" class="menu">
    <div class="title"> <h1> <i class="fa fa-book" aria-hidden="true"></i><span>Ж</span>урнал</h1> </div>
    <div class="list_menu">
        <ul>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'download'); showtable()"> <i class="fa fa-file" aria-hidden="true"></i> Загрузка журнала</a></li>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'edit'); showtable() " ><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Редактирование</a> </li>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'stat'); showtable()"><i class="fa fa-table" aria-hidden="true"></i> Таблица оценок</a></li>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'graph'); hidetable()"><i class="fa fa-area-chart" aria-hidden="true"></i> График оценок</a></li>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'help'); hidetable()"><i class="fa fa-user-o" aria-hidden="true"></i> Помощь</a></li>
            <li><a href="javascript:void(0)" onclick="openTab(event, 'about'); hidetable()"><i class="fa fa-paper-plane-o" aria-hidden="true"></i> О разработчике</a></li>
        </ul>
    </div>
    </div>
    <div class="footer_menu">
      <p>Демчак 2023</p>
    </div>
    <div class="content">

    

  <div id="download" class="tabcontent">
    
    <h3>Скачивание файлов</h3>
    <input type="file" id="fileInput" accept=".csv, .txt, .xlsx">
    <button onclick="handleFileUpload()">Загрузить</button>


  </div>

  

  <div id="edit" class="tabcontent">
    <h3>Редактировать оценки</h3>
    <button onclick="addTableData(); deleteCell2()">Добавить строку</button>
    <button onclick="deleterow(); addcells()">Добавить столбец</button>
    <button onclick="createtable()">Создать журнал</button>
    <button onclick="deleterow()">Удалить запись</button>

  </div>


  <div id="stat" class="tabcontent">
    <h3>Статистика (таблица)</h3>
    <input type="text" id="deti" placeholder="Класс">
    <button onclick="kolvo2(); sred(2); med1(); ">Загрузить статистику</button>
  <table border="1px" id="stat3">
<tr>
  <td></td>
  <td>informatics</td>
  <td>physics</td>
  <td>mathemathics</td>
  <td>literature</td>
  <td>music</td>
</tr>
<tr>
  <td>Средняя оценка</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>Медиана</td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
  </table>

  <table border="1px" id="stat4">
    <tr>
      <td></td>
      <td>informatics</td>
      <td>physics</td>
      <td>mathemathics</td>
      <td>literature</td>
      <td>music</td>
    </tr>
    <tr>
      <td>5</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>4</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>3</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
      </table>
  </div>

  <div id="graph" class="tabcontent">
    <h3></i>Статистика (график)</h3>
    <button onclick="removeAllColumns(); drawChart()">Показать график</button>
    <div class="graficc" id="chart_div" style="width: 1000px; height: 1000px;"></div>
  </div>

  <div id="help" class="tabcontent">
    <h3>Помощь</h3>
    <p>Это приложение для ведения онлайн-журнала оценки.</p>
    <p>Загрузка журнала - 
      на этой вкладке пользователь может загрузить оценки из файла формата .csv, .txt, .xlsx.</p>
    <p>Редактирование журнала - 
      На этой вкладке пользователь может создать новый журнал или отредактировать существующий. <br>
      Для удаления записи об ученике нужно оставить строку пустой и нажать на соответствующую кнопку. 
    </p>
    <p>Таблица оценок - 
      На этой вкладке пользователь может просмотреть статистику по журналу в табличном виде.
    </p>
    <p>График оценок - 
      На этой вкладке пользователь может просмотреть статистику по журналу в графическом виде.
    </p>
    <p>О разработчике - 
      На этой вкладке пользователь может найти информацию о создателе программы.
    </p>

  </div>

  <div id="about" class="tabcontent">
    <div class="orazrab">
      <h3>О разработчике</h3>
    <p>Демчак Денис Викторович</p>
    <p>Контактные данные: +79243874243, demchak.denis@gmail.com</p>
  </div>
    <div class="profile-pic"></div>
  </div>
  <table border="1" onclick="editTD()" id="downloadTable"></table>
</div>

  <script>
    function openTab(evt, tabName) {


        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
      }
  </script>

<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);
 
  function drawChart() {
    var options = {
      backgroundColor:  '#a0a1a6', 
      width: 1000, // минимальная ширина графика
      height: 1000,
      legend: { position: 'top' },
    };
     var data = new google.visualization.DataTable();
     data.addColumn('string', 'Ученик');
     data.addColumn('number', 'Средний балл');
 
     var table = document.getElementById('downloadTable');
     var numRows = table.rows.length;
 
     for (var i = 1; i < numRows; i++) {
       var row = table.rows[i];
       var category = row.cells[0].innerText;
       var value = parseFloat(row.cells[1].innerText);
       data.addRow([category, value]);
     }
 
     var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
     chart.draw(data,options);
  }
 </script>

  <script src="script.js"></script>
</body>
</html>
